<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Story Frames ‚Äî Personalized gifts that come to life</title>
  <meta name="description" content="Story Frames: Send us a photo ‚Äî we turn it into a short video and embed it in your chosen product. PayPal card payments, COD in Bulgaria." />

  <link rel="stylesheet" href="styles.css">
  <script defer src="i18n.js"></script>
  <!-- PayPal SDK - supports both PayPal and card payments -->
  <script src="https://www.paypal.com/sdk/js?client-id=AZDxjDScFpQtjWTOUtWKbyN_bDt4OgqaF4eYXlewfBP4-8aqX3PiV8e1GWU6liB2CUed2TK-uhjVCt_b&currency=EUR&intent=capture"></script>
</head>


<body>
  <div class="container">
    <header class="top">
      <a class="brand" href="index.html">
        <div class="logo"><img src="logo.png" alt="Story Frames"></div>
        <div>
          <strong>Story Frames</strong>
          <small data-i18n="tagline">Crafting stories from photos</small>
        </div>
      </a>

      <nav class="topnav">
        <a href="#products" data-i18n="nav_products">Products</a>
        <a href="#gallery" data-i18n="nav_gallery">Gallery</a>
        <a href="#service" data-i18n="nav_service">Service</a>
        <a class="pill" href="https://facebook.com/Storyframesvarna/" target="_blank" rel="noopener noreferrer">Facebook</a>

        <a class="cart-icon" onclick="toggleCart()" id="cartIcon">
          üõí <span data-i18n="cart">Cart</span>
          <span class="cart-badge" id="cartBadge" style="display:none;">0</span>
        </a>

        <div class="lang" aria-label="Language">
          <button class="langbtn" data-lang="en">EN</button>
          <button class="langbtn" data-lang="bg">BG</button>
        </div>
      </nav>
    </header>

    <section class="hero" id="top">
      <div>
        <h1 data-i18n="hero_title">Personalized gifts that come to life.</h1>
        <p data-i18n="hero_text">
          Send us a photo ‚Äî we transform it into a short video and embed it into your chosen product.
          A moving memory that feels premium, personal, and unforgettable.
        </p>

        <div class="actions">
          <a class="btn primary" href="#products" data-i18n="cta_products">View products</a>
          <a class="btn gold" href="mailto:Sviievmla@gmail.com?subject=Story%20Frames%20Order%20Inquiry" data-i18n="cta_email">Order by email</a>
          <a class="btn" href="https://facebook.com/Storyframesvarna/" target="_blank" rel="noopener noreferrer" data-i18n="cta_fb">Message on Facebook</a>
        </div>
      </div>

      <div class="hero-card">
        <b data-i18n="how_title">How ordering works</b>
        <ul>
          <li data-i18n="how_1">You send us your photo (even an old paper photo).</li>
          <li data-i18n="how_2">We turn it into a short ‚Äúmagic‚Äù video story.</li>
          <li data-i18n="how_3">We deliver it inside your selected product.</li>
        </ul>
      </div>
    </section>

    <section id="products">
      <div class="section-title">
        <h2 data-i18n="products_title">Products</h2>
      </div>

      <div class="products">
        <a class="card" href="video-ball.html">
          <div class="img">
            <img src="ball-1.jpg" alt="Video Ball">
          </div>
          <div class="body">
            <h3 data-i18n="p1_title">Video Ball</h3>
            <p data-i18n="p1_desc">A modern spherical display with your animated memory inside.</p>
            <button class="order-btn" onclick="addToCart('Video Ball', 39, 'ball-1.jpg', event); event.preventDefault();" data-i18n="order_now">Order</button>
          </div>
          <div class="meta">
            <div>
              <div class="price">‚Ç¨39</div>
              <div class="tiny" data-i18n="pay_physical">PayPal (card) ‚Ä¢ Bulgaria COD</div>
            </div>
            <div class="tag" data-i18n="open_details">Open details ‚Üí</div>
          </div>
        </a>

        <a class="card" href="premium-frame.html">
          <div class="img">
            <img src="frame-1.jpg" alt="Premium Frame">
          </div>
          <div class="body">
            <h3 data-i18n="p2_title">Premium Frame</h3>
            <p data-i18n="p2_desc">A clean, premium digital frame for memories that deserve a spotlight.</p>
            <button class="order-btn" onclick="addToCart('Premium Frame', 49.99, 'frame-1.jpg', event); event.preventDefault();" data-i18n="order_now">Order</button>
          </div>
          <div class="meta">
            <div>
              <div class="price">‚Ç¨49.99</div>
              <div class="tiny" data-i18n="pay_physical">PayPal (card) ‚Ä¢ Bulgaria COD</div>
            </div>
            <div class="tag" data-i18n="open_details">Open details ‚Üí</div>
          </div>
        </a>

        <a class="card" href="digital-card.html">
          <div class="img">
            <img src="card-1.jpg" alt="Digital Greeting Card">
          </div>
          <div class="body">
            <h3 data-i18n="p3_title">Digital Greeting Card</h3>
            <p data-i18n="p3_desc">A stylish digital card with your story and your music.</p>
            <button class="order-btn" onclick="addToCart('Digital Greeting Card', 29, 'card-1.jpg', event); event.preventDefault();" data-i18n="order_now">Order</button>
          </div>
          <div class="meta">
            <div>
              <div class="price">‚Ç¨29</div>
              <div class="tiny" data-i18n="pay_digital">PayPal (card) ‚Ä¢ Instant delivery</div>
            </div>
            <div class="tag" data-i18n="open_details">Open details ‚Üí</div>
          </div>
        </a>
      </div>
    </section>

    <section id="gallery">
      <div class="section-title">
        <h2 data-i18n="gallery_title">Gallery</h2>
        <p data-i18n="gallery_hint" style="margin:0;color:var(--muted)">Click any photo to view it bigger.</p>
      </div>

      <div class="gallery">
        <div class="shot" onclick="openLightbox('gallery-1.jpg')"><img src="gallery-1.jpg" alt="Gallery 1"></div>
        <div class="shot" onclick="openLightbox('gallery-2.jpg')"><img src="gallery-2.jpg" alt="Gallery 2"></div>
        <div class="shot" onclick="openLightbox('gallery-3.jpg')"><img src="gallery-3.jpg" alt="Gallery 3"></div>
      </div>
    </section>

    <section id="service">
      <div class="section-title">
        <h2 data-i18n="service_title">Service</h2>
      </div>

      <div class="two">
        <div class="panel">
          <h3 data-i18n="about_title">STORY FRAMES ‚Äî The most innovative gift</h3>
          <p data-i18n="about_text">
            Bring memories to life: every photo becomes a short video. We offer digital frames for your memories
            and digital invitation / greeting cards. Warm someone‚Äôs heart with a moving memory. Message us to order. ‚ú®
          </p>
        </div>

        <div class="panel">
          <h3 data-i18n="why_title">Why choose a digital card?</h3>
          <ul>
            <li data-i18n="why_1">‚ú® <b>Living memories:</b> we transform even an old paper photo into a short video story.</li>
            <li data-i18n="why_2">üéÅ <b>A gift that impresses:</b> perfect for birthdays, anniversaries, holidays ‚Äî or ‚Äújust because‚Äù.</li>
            <li data-i18n="why_3">üéµ <b>Your personal soundtrack:</b> add the song that matters to you.</li>
            <li data-i18n="why_4">üì± <b>Stylish & lasting:</b> compact, easy to keep, and brings a smile every time.</li>
            <li data-i18n="why_5">üíñ <b>Fully personalized:</b> designed for your unique story.</li>
          </ul>
          <p style="margin-top:12px;color:var(--muted)" data-i18n="quote">
            ‚ÄúFlowers fade, chocolates get eaten ‚Äî but the feeling you share stays forever.‚Äù
          </p>
        </div>
      </div>
    </section>

    <footer>
      <div>¬© <span id="year"></span> Story Frames</div>
      <div style="display:flex;gap:12px;flex-wrap:wrap;">
        <a href="mailto:Sviievmla@gmail.com">Sviievmla@gmail.com</a>
        <a href="https://facebook.com/Storyframesvarna/" target="_blank" rel="noopener noreferrer">Facebook</a>
      </div>
    </footer>
  </div>

  <div class="lightbox" id="lightbox" onclick="closeLightbox()">
    <img id="lightboxImg" alt="Expanded image" />
  </div>

  <!-- Shopping Cart Modal -->
  <div class="cart-modal" id="cartModal">
    <div class="cart-content">
      <div class="cart-header">
        <h2 data-i18n="cart_title">Shopping Cart</h2>
        <button class="close-cart" onclick="toggleCart()">‚úï</button>
      </div>
      
      <div id="cartItemsContainer">
        <!-- Cart items will be inserted here -->
      </div>
      
      <div id="cartEmpty" class="empty-cart" style="display:none;">
        <div class="empty-cart-icon">üõí</div>
        <p data-i18n="cart_empty">Your cart is empty</p>
      </div>
      
      <div id="cartSummary" style="display:none;">
        <div class="cart-total">
          <div class="cart-total-row">
            <span data-i18n="subtotal">Subtotal:</span>
            <span id="cartSubtotal">‚Ç¨0.00</span>
          </div>
          <div class="cart-total-row">
            <span data-i18n="total">Total:</span>
            <span id="cartTotal">‚Ç¨0.00</span>
          </div>
        </div>
        
        <a href="checkout.html" class="checkout-button" data-i18n="checkout_btn">Proceed to Checkout</a>
        
        <!-- PayPal Smart Payment Buttons Container -->
        <div id="paypal-button-container" style="margin-top: 8px;"></div>
        
        <div class="cart-actions" style="margin-top: 12px;">
          <button class="btn" onclick="clearCart()" data-i18n="clear_cart">Clear Cart</button>
        </div>
      </div>
    </div>
  </div>

  <script>
    document.getElementById("year").textContent = new Date().getFullYear();

    // Shopping Cart Management
    let cart = JSON.parse(localStorage.getItem('storyframesCart') || '[]');

    function updateCartUI() {
      const badge = document.getElementById('cartBadge');
      const itemsContainer = document.getElementById('cartItemsContainer');
      const emptyMessage = document.getElementById('cartEmpty');
      const summary = document.getElementById('cartSummary');
      const totalElement = document.getElementById('cartTotal');
      const subtotalElement = document.getElementById('cartSubtotal');
      
      // Update badge
      const totalItems = cart.reduce((sum, item) => sum + (item.quantity || 1), 0);
      if (totalItems > 0) {
        badge.style.display = 'flex';
        badge.textContent = totalItems;
      } else {
        badge.style.display = 'none';
      }
      
      // Update cart contents
      if (cart.length === 0) {
        itemsContainer.innerHTML = '';
        emptyMessage.style.display = 'block';
        summary.style.display = 'none';
      } else {
        emptyMessage.style.display = 'none';
        summary.style.display = 'block';
        
        itemsContainer.innerHTML = '<ul class="cart-items">' +
          cart.map((item, index) => {
            const quantity = item.quantity || 1;
            const itemTotal = item.price * quantity;
            return `
            <li class="cart-item">
              <img src="${item.image}" alt="${item.name}" class="cart-item-image">
              <div class="cart-item-details">
                <div class="cart-item-title">${item.name}</div>
                <div class="cart-item-price">‚Ç¨${item.price.toFixed(2)} √ó ${quantity} = ‚Ç¨${itemTotal.toFixed(2)}</div>
                <div class="quantity-controls">
                  <button class="quantity-btn" onclick="updateQuantity(${index}, -1)">‚àí</button>
                  <input type="number" class="quantity-input" value="${quantity}" min="1" max="999" onchange="setQuantity(${index}, this.value)">
                  <button class="quantity-btn" onclick="updateQuantity(${index}, 1)">+</button>
                </div>
              </div>
              <button class="remove-item" onclick="removeFromCart(${index})" data-i18n="remove">Remove</button>
            </li>
          `;
          }).join('') +
        '</ul>';
        
        const subtotal = cart.reduce((sum, item) => sum + (item.price * (item.quantity || 1)), 0);
        const total = subtotal; // Can add shipping/tax here later
        
        if (subtotalElement) {
          subtotalElement.textContent = `‚Ç¨${subtotal.toFixed(2)}`;
        }
        totalElement.textContent = `‚Ç¨${total.toFixed(2)}`;
        
        // Apply translations if i18n is loaded
        if (window.i18n) {
          document.querySelectorAll('[data-i18n]').forEach(element => {
            const key = element.getAttribute('data-i18n');
            const translation = window.i18n.t(key);
            if (translation !== key) {
              element.textContent = translation;
            }
          });
        }
      }
      
      localStorage.setItem('storyframesCart', JSON.stringify(cart));
      
      // Render PayPal buttons if cart has items
      if (cart.length > 0) {
        renderPayPalButtons();
      }
    }

    function updateQuantity(index, change) {
      if (cart[index]) {
        const currentQty = cart[index].quantity || 1;
        const newQty = currentQty + change;
        if (newQty > 0) {
          cart[index].quantity = newQty;
          updateCartUI();
        }
      }
    }

    function setQuantity(index, value) {
      const qty = parseInt(value, 10);
      if (cart[index] && qty > 0 && !isNaN(qty)) {
        cart[index].quantity = qty;
        updateCartUI();
      } else if (qty <= 0 || isNaN(qty)) {
        removeFromCart(index);
      }
    }

    // Render PayPal Smart Payment Buttons
    function renderPayPalButtons() {
      const container = document.getElementById('paypal-button-container');
      if (!container) return;
      
      // Clear existing buttons
      container.innerHTML = '';
      
      if (cart.length === 0) return;
      
      const total = cart.reduce((sum, item) => sum + (item.price * (item.quantity || 1)), 0);
      
      // Render PayPal buttons
      paypal.Buttons({
        style: {
          layout: 'vertical',
          color: 'gold',
          shape: 'rect',
          label: 'paypal'
        },
        
        createOrder: function(data, actions) {
          // Create order with cart items
          return actions.order.create({
            purchase_units: [{
              description: 'Story Frames Order',
              amount: {
                currency_code: 'EUR',
                value: total.toFixed(2),
                breakdown: {
                  item_total: {
                    currency_code: 'EUR',
                    value: total.toFixed(2)
                  }
                }
              },
              items: cart.map(item => ({
                name: item.name,
                unit_amount: {
                  currency_code: 'EUR',
                  value: item.price.toFixed(2)
                },
                quantity: String(item.quantity || 1)
              }))
            }]
          });
        },
        
        onApprove: function(data, actions) {
          // Capture the payment
          return actions.order.capture().then(function(details) {
            // Payment successful
            alert('Payment successful! Order ID: ' + details.id + '\n\nThank you, ' + details.payer.name.given_name + '!\n\nWe will send you an email confirmation shortly.');
            
            // Send order details via email
            sendOrderConfirmation(details);
            
            // Clear the cart
            cart = [];
            updateCartUI();
            toggleCart();
          });
        },
        
        onError: function(err) {
          console.error('PayPal error:', err);
          alert('An error occurred during payment. Please try again.');
        },
        
        onCancel: function(data) {
          alert('Payment cancelled. Your items are still in the cart.');
        }
      }).render('#paypal-button-container');
    }

    // Send order confirmation email
    function sendOrderConfirmation(details) {
      const itemsList = cart.map(item => `${item.name} √ó ${item.quantity || 1} - ‚Ç¨${(item.price * (item.quantity || 1)).toFixed(2)}`).join('\n');
      const total = cart.reduce((sum, item) => sum + (item.price * (item.quantity || 1)), 0);
      
      const subject = 'Story Frames Order Confirmation - ' + details.id;
      const body = [
        'Order Confirmation',
        '',
        'Transaction ID: ' + details.id,
        'Customer: ' + details.payer.name.given_name + ' ' + details.payer.name.surname,
        'Email: ' + details.payer.email_address,
        '',
        'Items Ordered:',
        itemsList,
        '',
        `Total Paid: ‚Ç¨${total.toFixed(2)}`,
        '',
        'Please send your photos to complete the order.',
        '',
        'Shipping Address:',
        details.purchase_units[0].shipping ? JSON.stringify(details.purchase_units[0].shipping.address, null, 2) : 'N/A'
      ].join('\n');
      
      // Open email client with order details
      window.open(`mailto:Sviievmla@gmail.com?subject=${encodeURIComponent(subject)}&body=${encodeURIComponent(body)}`, '_blank');
    }

    function addToCart(name, price, image, event) {
      // Check if item already exists in cart
      const existingIndex = cart.findIndex(item => item.name === name);
      
      if (existingIndex >= 0) {
        // Increment quantity if item exists
        cart[existingIndex].quantity = (cart[existingIndex].quantity || 1) + 1;
      } else {
        // Add new item with quantity 1
        cart.push({ name, price, image, quantity: 1 });
      }
      
      updateCartUI();
      
      // Show a brief notification
      const btn = event.target;
      const originalText = btn.textContent;
      btn.textContent = '‚úì Added!';
      btn.style.background = 'linear-gradient(180deg, rgba(40,180,99,.35), rgba(255,255,255,.05))';
      setTimeout(() => {
        btn.textContent = originalText;
        btn.style.background = '';
      }, 1500);
    }

    function removeFromCart(index) {
      cart.splice(index, 1);
      updateCartUI();
    }

    function clearCart() {
      if (confirm('Are you sure you want to clear your cart?')) {
        cart = [];
        updateCartUI();
      }
    }

    function toggleCart() {
      const modal = document.getElementById('cartModal');
      modal.classList.toggle('active');
      if (modal.classList.contains('active')) {
        document.body.style.overflow = 'hidden';
      } else {
        document.body.style.overflow = '';
      }
    }

    // Close cart when clicking outside
    document.getElementById('cartModal').addEventListener('click', function(e) {
      if (e.target === this) {
        toggleCart();
      }
    });

    // Initialize cart UI
    updateCartUI();

    // Open cart if URL has #cart
    if (window.location.hash === '#cart') {
      toggleCart();
    }

    function openLightbox(src){
      document.getElementById("lightboxImg").src = src;
      document.getElementById("lightbox").style.display = "flex";
      document.body.style.overflow = "hidden";
    }
    function closeLightbox(){
      document.getElementById("lightbox").style.display = "none";
      document.body.style.overflow = "";
    }
  </script>
</body>
</html>
